// Potato
// Copyright © 2014 Carl Hewett

// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.

// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.

// You should have received a copy of the GNU General Public License
// along with this program.  If not, see <http://www.gnu.org/licenses/>.

exports.Potato = function(socket, x, y, nick, registered, online) // Socket.io socket
{
	var potato = {};
	
	var mSocket = socket;
	var mX = 0;
	var mY = 0;
	var mNick = nick;
	var mRegistered = registered;
	var mNewChatMessages = [];
	
	var mOnline = online;
	
	potato.getSocket = function()
	{
		return mSocket;
	};
	
	potato.setCoords = function(x, y)
	{
		mX = x;
		mY = y;
	};
	
	potato.getNick = function(nick, registered)
	{
		return mNick;
	};
	
	potato.setNick = function(nick, registered)
	{
		mNick = nick;
		mRegistered = registered;
	};
	
	potato.getOnline = function()
	{
		return mOnline;
	};
	
	potato.setOnline = function(online)
	{
		mOnline = online;
	};
	
	potato.getData = function()
	{
		var data = {};
		data.coords = {};
		data.coords.x = mX;
		data.coords.y = mY;
		data.nick = mNick;
		data.registered = mRegistered;
		data.id = mSocket.id;
		data.newChatMessages = mNewChatMessages;
		data.online = mOnline;
		
		mNewChatMessages = []; // Clear chat messages
		return data;
	};
	
	potato.addNewChatMessages = function(newChatMessages)
	{
		if(mNewChatMessages.length==0 && newChatMessages.length==1) // Fast! Most of the time this will be it, so make it fast!
		{
			mNewChatMessages = [newChatMessages[0]];
		} else
		{
			for(var i=0, length=newChatMessages.length; i<length; i++)
			{
				mNewChatMessages.push(newChatMessages[i]);
			}
		}
	};
	
	return potato;
};